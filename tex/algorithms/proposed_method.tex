\balg%
    \caption{The proposed initialisation method}\label{alg:proposed_method}
    \KwIn{a dataset \(\mathcal{X} \subset \mathcal{A}\), a number of modes to
        find \(k\)}
    \KwOut{a set of \(k\) initial modes \(\overline Z\)}

    \(\widehat Z \gets \emptyset\)\;
    \(\overline Z \gets \emptyset\)\;
    \(R \gets \emptyset\)\;
    \(H \gets \emptyset\)\;

    \For{\(j = 1, \ldots, m\)}{%
        \For{\(s = 1, \ldots, d_j\)}{%
            Calculate \(\frac{n(a_s^{(j)})}{N}\)
        }
    }

    \For{\(l = 1, \ldots, k\)}{%
        Create an empty \(m\)-tuple \(\hat{z}^{(l)}\)\;
        \For{\(j = 1, \ldots, m\)}{%
            Sample \(a_{s^*}^{(j)}\) from \(A_j\) with respect to the
            relative frequencies of \(A_j\)\;
            \(\hat{z}_j^{(l)} \gets a_{s^*}^{(j)}\)
        }

        \(\widehat Z \gets \widehat Z \cup \left\{\hat{z}^{(l)}\right\}\)
    }

    \(R \gets \widehat Z\)\;
    \For{\(r \in R\)}{%
        \(c_r \gets 1\)
        Find the set of \(k\) data points \(H_r \subset \mathcal{X}\) that 
        are the least dissimilar to \(r\)\;
        Arrange \(H_r\) into descending order of similarity with respect to
        \(r\)\;
        \(H \gets H \cup H_r\)\;
        \(g(r) \gets H_r\)\;
    }
    
    Select a method for suitor preference lists and construct \(f(s)\)
    accordingly for each \(s \in S\)\;
    
    Solve the matching game defined by \((R, H)\) to obtain a matching \(M\)\;
    \For{\(r \in R\)}{%
        \(\overline Z \gets \overline Z \cup \left\{M(r)\right\}\)
    }
\ealg%
