\balg%
    \caption{The \(k\)-modes algorithm}\label{alg:kmodes}
    \KwIn{a dataset \(\mathcal{X}\), a number of clusters to form \(k\)}
    \KwOut{a clustering \(\mathcal{Z}\) of \(\mathcal{X}\)}

    Select \(k\) initial modes \(z^{(1)}, \ldots, z^{(k)} \in \mathcal{X}\)\;
    \(\overline Z \gets \left\{z^{(1)}, \ldots, z^{(k)}\right\}\)\;
    \(\mathcal{Z} \gets \left(\left\{z^{(1)}\right\}, \ldots,
    \left\{z^{(k)}\right\}\right)\)\;

    \For{\(X^{(i)} \in \mathcal{X}\)}{%
        Select \(l^* \) that minimises \(d(X^{(i)}, z^{(l)})\)\;
        \(Z_{l^*} \gets Z_{l^*} \cup \left\{X^{(i)}\right\}\)\;
        \(\textsc{Update}(z^{(l^*)})\)\;
    }

    \Repeat{No point changes cluster after a full cycle through
    \(\mathcal{X}\)}{%
        \For{\(X^{(i)} \in \textbf{X}\)}{%
            \For{\(\mu^{(l)} \in \bar{\mu}\)}{%
                Calculate \(d(X^{(i)}, \mu^{(l)})\)\;
            }
            \If{\(d(X^{(i)}, \mu^{(l^*)}) > d(X^{(i)}, \mu^{(l')}) \ \text{for some} \ l' \neq l^*\)}{%
                \(C_{l^*} \gets C_{l^*} \setminus \left\{X^{(i)}\right\}\)\;
                \(C_{l'} \gets C_{l'} \cup \left\{X^{(i)}\right\}\)\;
                \textsc{Update}\((\mu^{(l^*)})\) and \textsc{Update}\((\mu^{(l')})\).\;
            }
        }
    }
\ealg%

